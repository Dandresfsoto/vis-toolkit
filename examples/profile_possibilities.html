<!doctype html>
<meta charset="utf-8">
<script src="../js/d3.js" charset="utf-8"></script>
<script src="../js/vistk.js"></script>
<link href="../css/vistk.css" rel="stylesheet">
<link href="../css/profiles.css" rel="stylesheet">
<body>
<div id="viz"></div>

<table width="100%">

  <tr><td colspan="2">Blablablah</td></tr>
  <tr><td width="80%"><div id="js-product-space"></div></td><td>

    <div id="js-dotplot-complexity">
      <input name="story" value="step0" type="radio" checked/>Original graph<br>      
      <input name="story" value="step1" type="radio" />Step 1<br>
      <input name="story" value="step2" type="radio" />Step 2<br>    
      <input name="story" value="step3" type="radio" />Step 3<br>          
    </div>
  </td></tr>

</table>

<script>


//d3.json("../data/product_space_hs4.json", function(error, products) {

  d3.json("../data/network_hs.json", function(graph) {

    // Data cleaning
    graph.nodes.forEach(function(node){
      node.id = node._id.slice(2, 6);
      node.category = node._id.slice(0, 2);      
    });

    visualization = vistk.viz()
      .data(graph.nodes)
      .links(graph.links)      
      .height(300)
      .width(400)
 //     .join(products.data, "id")
      .type("nodelink")
      .container("#js-product-space")
      .x_var("nb_products")
      .y_var("avg_products")
      .id(["category", "id"])
      .group("category")
      .size("value")
      .time(2012)
      .color("category")
      .title("Product space")
      .ui(false)

    d3.select("#viz")
      .call(visualization)


    d3.select("input[value='step0']").on("click", function() { 
      vars.evt.call("highlightOut");
    });

    d3.select("input[value='step1']").on("click", function() { 
      vars.evt.call("highlightOn", vars.data[Math.floor(vars.data.length*Math.random())]);
    });

    d3.select("input[value='step2']").on("click", function() { 
      vars.evt.call("highlightOn", vars.data[Math.floor(vars.data.length*Math.random())]);
    });

    d3.select("input[value='step3']").on("click", function() { 
      vars.evt.call("highlightOn", vars.data[Math.floor(vars.data.length*Math.random())]);
    });

  });

//});

</script>
