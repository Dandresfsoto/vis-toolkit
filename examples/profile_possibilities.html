<!doctype html>
<meta charset="utf-8">
<script src="../js/d3.js" charset="utf-8"></script>
<script src="../js/vistk.js"></script>
<link href="../css/vistk.css" rel="stylesheet">
<link href="../css/profiles.css" rel="stylesheet">
<body>
<div id="viz"></div>

<table width="100%">

  <tr><td colspan="2">Export possibilities</td></tr>
  <tr><td width="80%"><div id="js-product-space"></div></td><td>
  <div id="js-table-products"></div>
  </td></tr>

</table>

<script>

d3.json("../data/atlas_international_product_space.json", function(graph) {

  d3.json("../data/col_dept_exports_3.json", function(exports) {

    console.log(exports)

    // Data cleaning
    graph.nodes.forEach(function(node){
      //node.id = node._id.slice(2, 6);
      node.category = node.id.slice(0, 2);      
    });

    visualization = vistk.viz()
      .nodes(graph.nodes)
      .links(graph.edges)
      .data(exports)
      .height(300)
      .width(400)
      .type("nodelink")
      .container("#js-product-space")
      .x_var("nb_products")
      .y_var("avg_products")
      .id("product_id")
      .group("category")
      .size("value")
      .time(2012)
      .color("category")
      .title("Product space")
      .ui(false)

    d3.select("#viz").call(visualization)
/*
    table_products = vistk.viz()
      .type("table")
      .width(400)
      .height(300)
      .container("#js-table-products")
      .data(graph.nodes)
      .columns(['id', 'category'])
      .id(["id"])
      .text("id")
      .title("Top Exports, all")
      .ui(false);

    d3.select("#js-table-products").call(table_products);
*/
  });

});


</script>
